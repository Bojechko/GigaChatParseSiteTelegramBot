# GigaChatParseSiteTelegramBot
# Что было сделано, что получилось, а что не очень, что попробовал.
 
Я решил выбрать гигачат, т.к. к нему сейчас самый простой и стабильный доступ из РФ. 

В первую очередь, я начал изучать документацию к нему. Она оказалась всеобъемлющей. Из нее я понял, что мне необходимо использовать
RAG, т.к. он отвечает на вопросы исходя из информации в контексте. В документации приложен репозиторий гитхаба с примерами 
реализации в Jupyter notebook.

Я решил использовать пример, пререписав его под ООП. В классе EmbeddingCreator можно задать ретривер, передав его в конструктор
Я опробовал топ 6 ретриверов из лидерборда https://github.com/avidale/encodechka#%D0%BB%D0%B8%D0%B4%D0%B5%D1%80%D0%B1%D0%BE%D1%80%D0%B4
В итоге, как это не странно, самым качественным оказался deepvk/USER-bge-m3, но он долго запускается. 
Самым шустрым по запуску оказался sentence-transformers/paraphrase-multilingual-mpnet-base-v2. Он так же показывает хорошие результаты,
но плохо себя показывает на запрос "Что вы сделали для Магнита?". Видимо, он воспринимает его как магнит, а не компанию.

В классе GigaChatRequester создается сам гигачат путем загрузки в него контекста, промпта, а так же токена сбера (хранится в .env).
Ссылки перечислены в списке в файле config.

Я поигрался с промптом, но так и не смог заставить его отдавать ссылки на информацию. К сожалению, лимит бесплатных запросов кончился раньше.
`gigachat.exceptions.ResponseError: (URL('https://gigachat.devices.sberbank.ru/api/v1/chat/completions'), 402, b'{"status":402,"message":"Payment Required"}\n'`

При желании, промпт можно передать в гигачат при инициализации объекта. Нужно дать его строкой в конструктор.

Бот способен отвечать на вопросы: 
1) `Что вы можете сделать для ретейлеров?` - Даст ответ в общих чертах.
2) `Что вы можете сделать для ретейлеров?  Приведи компании и их кейсы.` - Даст информацию в общих чертах, а так же приведет пример кейса и название компании.
3) `Что было сделано для магнита?` - расскажет, что было сделано для него.
4) `Перечисли клиентов` - на данный вопрос он перечислит несколько клиентов. Ответ на этот вопрос дал лучше всех ретривер symanto/sn-xlm-roberta-base-snli-mnli-anli-xnli
5) Вопрос, на который нет информации в контексте - скажет, что ее нет.

Была использована llm GigaChat-Pro, т.к. она лучше справляется с ответами, однако лимитирована по количеству токенов. 
Обычная GigaChat справляется хуже с ответами, но так же достойно (Она не смогла ответить на 4 вопрос).

Я не до конца доволен ответами бота, и.к. требуется уточнять вопрос, для получения примеров. Так же не получилось выпросить из него ссылки на источник информации.
Однако, бот справляется с задачей консультирования пользователя и прост для изменения каких либо параметров.

Для удобства запихнул это в докер контейнер. Докер файл прилагаю. 

# Что бы я добавил/изменил.

Попробовал комбинировать несколько ретриверов.

Еще бы поигрался с промптом.

Попробовал бы другие llm.

# Запуск

Создать файл .env и задать токены (из файла .env_example). Установить библиотеки из requirements, запустит app.py или запустить докер контейнер.
